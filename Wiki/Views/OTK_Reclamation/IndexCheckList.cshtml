@model IEnumerable<Wiki.OTK_Reclamation>

@{
    ViewBag.Title = "IndexCheckList";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<head>
    <link href="~/Content/Scripts/bootstrap-table.min.css" rel="stylesheet" />
    <link href="~/Content/Scripts/bootstrap.min.css" rel="stylesheet" />
    <script src="~/Scripts/bootstrap.min.js"></script>
    <script src="~/Scripts/bootstrap-datetimepicker.min.js"></script>
    <link href="~/Content/bootstrap-datetimepicker.min.css" rel="stylesheet" />
    <style>
        .container {
            height: 650px;
            width: 1600px;
            overflow: auto;
        }

        th {
            background: #000080; /* Цвет фона строки заголовка */
            color: #ffe; /* Цвет текста */
            text-align: left; /* Выравнивание по левому краю */
            font-family: Arial, Helvetica, sans-serif; /* Выбор гарнитуры */
            font-size: 0.9em; /* Размер текста */
        }

        .form-control {
            width: 600px;
            max-width: none !important;
        }
    </style>
</head>
<div>
    <h5>Чек-лист заказа № @ViewBag.CheckList.PZ_PlanZakaz.PlanZakaz</h5>
    <h5 style="width:800px">@ViewBag.CheckList.PZ_PlanZakaz.Name</h5>
    <div>
        Создан: @ViewBag.CheckList.DateCreate
    </div>
    <div>
        Кем создан: @ViewBag.CheckList.AspNetUsers.CiliricalName
    </div>
    <br />
    <span>
        @Html.ActionLink("Добавить запись", "CreatePartial", null, new { idf = (object)ViewBag.CheckList.id }, new { @class = "btn-sm btn-info viewDialog1", data_dialog_title = "Добавить рекламацию" })
        @Html.ActionLink("Чек-листы", "Index", "OTK_ChaeckList", new { myDevision = ViewBag.myId }, new { @class = "btn-sm btn-primary" })
        @Html.ActionLink("Оптичить все рекламации", "ComplitedAllTask", null, new { idf = (object)ViewBag.CheckList.id, id = "myLink" }, new { @class = "btn-sm btn-success" })
    </span>
    <hr />
</div>
<div class="container">
    <table data-toggle="table" data-height="650">
        <thead>
            <tr>
                <th> Ред. </th>
                <th width="10"> № </th>
                <th width="250"> Тип </th>
                <th width="10"> Закрыта </th>
                <th width="300"> Рекламация </th>
                <th width="150"> Прим. </th>
                <th width="10"> Тр-ты ОТК </th>
                <th width="10"> Тр-ты ПУ </th>
                <th width="250"> Ответ </th>
                <th width="50"> СП </th>
                <th width="100"> Открыта </th>
                <th width="100"> Ответ от </th>
                <th> Уд. </th>
            </tr>
        </thead>
        <tbody id="myTable">
            @foreach (var item in Model)
            {

                if (item.AnswerText == "")
                {
                    <tr class="danger">
                        <td>@Html.ActionLink("Ред.", "EditPartial", "OTK_Reclamation", new { id = item.Id, cl = item.OTK_ChaeckList.id }, new { @class = "viewDialog", data_dialog_title = "Изменить запись" })</td>
                        <td width="10"> @Html.DisplayFor(modelItem => item.Id) </td>
                        <td width="250"> @Html.DisplayFor(modelItem => item.OTK_TypeReclamation.Name) </td>
                        <td width="10"> @Html.DisplayFor(modelItem => item.Complited) </td>
                        <td width="300"> @Html.DisplayFor(modelItem => item.ReclamationText) </td>
                        <td width="150"> @Html.DisplayFor(modelItem => item.Description) </td>
                        <td width="10"> @Html.DisplayFor(modelItem => item.LaborCostOTK) </td>
                        <td width="10"> @Html.DisplayFor(modelItem => item.LaborCostManufacturing) </td>
                        <td width="250"> @Html.DisplayFor(modelItem => item.AnswerText) </td>
                        <td width="50"> @Html.DisplayFor(modelItem => item.Devision1.name) </td>
                        <td width="100"> @item.DateTimeCreate.ToString() </td>
                        <td width="100"> @item.AnswerDate.ToString() </td>
                        <td> @Html.ActionLink("Уд.", "Delete", new { id = item.Id, cl = item.OTK_ChaeckList.id }, null) </td>
                    </tr>
                }
                else if (item.Complited == true)
                {
                    <tr>
                        <td>@Html.ActionLink("Ред.", "EditPartial", "OTK_Reclamation", new { id = item.Id, cl = item.OTK_ChaeckList.id }, new { @class = "viewDialog", data_dialog_title = "Изменить запись" })</td>
                        <td width="10"> @Html.DisplayFor(modelItem => item.Id) </td>
                        <td width="250"> @Html.DisplayFor(modelItem => item.OTK_TypeReclamation.Name) </td>
                        <td width="10"> @Html.DisplayFor(modelItem => item.Complited) </td>
                        <td width="300"> @Html.DisplayFor(modelItem => item.ReclamationText) </td>
                        <td width="150"> @Html.DisplayFor(modelItem => item.Description) </td>
                        <td width="10"> @Html.DisplayFor(modelItem => item.LaborCostOTK) </td>
                        <td width="10"> @Html.DisplayFor(modelItem => item.LaborCostManufacturing) </td>
                        <td width="250"> @Html.DisplayFor(modelItem => item.AnswerText) </td>
                        <td width="50"> @Html.DisplayFor(modelItem => item.Devision1.name) </td>
                        <td width="100"> @item.DateTimeCreate.ToString() </td>
                        <td width="100"> @item.AnswerDate.ToString() </td>
                        <td> @Html.ActionLink("Уд.", "Delete", new { id = item.Id, cl = item.OTK_ChaeckList.id }, null) </td>
                    </tr>
                }
                else
                {
                    <tr class="warning">
                        <td>@Html.ActionLink("Ред.", "EditPartial", "OTK_Reclamation", new { id = item.Id, cl = item.OTK_ChaeckList.id }, new { @class = "viewDialog", data_dialog_title = "Изменить запись" })</td>
                        <td width="10"> @Html.DisplayFor(modelItem => item.Id) </td>
                        <td width="250"> @Html.DisplayFor(modelItem => item.OTK_TypeReclamation.Name) </td>
                        <td width="10"> @Html.DisplayFor(modelItem => item.Complited) </td>
                        <td width="300"> @Html.DisplayFor(modelItem => item.ReclamationText) </td>
                        <td width="150"> @Html.DisplayFor(modelItem => item.Description) </td>
                        <td width="10"> @Html.DisplayFor(modelItem => item.LaborCostOTK) </td>
                        <td width="10"> @Html.DisplayFor(modelItem => item.LaborCostManufacturing) </td>
                        <td width="250"> @Html.DisplayFor(modelItem => item.AnswerText) </td>
                        <td width="50"> @Html.DisplayFor(modelItem => item.Devision1.name) </td>
                        <td width="100"> @item.DateTimeCreate.ToString() </td>
                        <td width="100"> @item.AnswerDate.ToString() </td>
                        <td> @Html.ActionLink("Уд.", "Delete", new { id = item.Id, cl = item.OTK_ChaeckList.id }, null) </td>
                    </tr>
                }
            }
        </tbody>
    </table>
</div>



<script src="~/Content/Scripts/bootstrap-table.min.js"></script>
<script src="~/Content/Scripts/jquery.min.js"></script>

<script>
    $(document).ready(function () {
        $('table tr').on('click', function (e) {
            $('table tr').removeClass('marked');
            $(this).addClass('marked');
        });
    });
</script>

<script>
    $('#myLink').click(function (
    ) {
    }
    );
</script>
<script src='@Url.Content("~/Scripts/jquery-3.1.1.min.js")' type="text/javascript"></script>
<script src='@Url.Content("~/Scripts/jquery-ui-1.12.1.min.js")' type="text/javascript"></script>
<script>
    $(document).ready(function () {
        $.ajaxSetup({ cache: false });
        $(".viewDialog").on("click", function (e) {
            e.preventDefault();
            $("<div></div>")
                .addClass("dialog")
                .appendTo("body")
                .dialog({
                    title: $(this).attr("data-dialog-title"),
                    close: function () { $(this).remove() },
                    width: 1200,
                    height: 700,
                    modal: true
                })
                .load(this.href);
        });
    });
</script>
<script>
    $(document).ready(function () {
        $.ajaxSetup({ cache: false });
        $(".viewDialog1").on("click", function (e) {
            e.preventDefault();
            $("<div></div>")
                .addClass("dialog")
                .appendTo("body")
                .dialog({
                    title: $(this).attr("data-dialog-title"),
                    close: function () { $(this).remove() },
                    width: 650,
                    height: 740,
                    modal: true
                })
                .load(this.href);
        });
    });
</script>

