@model Wiki.RKD_Order
@{
    ViewBag.Title = "Create";
    Layout = "~/Views/Shared/_LayoutRKD.cshtml";
}
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Index</title>
    <style>
        .container {
            max-width: none !important;
            width: 1500px;
        }

        .form-control {
            max-width: none !important;
            width: 1500px;
        }
    </style>
</head>
<body>
    <div class="row">
<div class="col-sm-1"></div>
<div class="col-sm-10">
    <table>
        @if (@ViewBag.PredcwssorOrderLink > 0)
        {
            <tr style="vertical-align: top;">
                @try
                {
                    @Html.ActionLink("Предыдущий заказ", "OpenOrder", "RKD", new { idOrder = @ViewBag.PredcwssorOrderLink }, null)
                }
                catch
                {

                }
            </tr>
        }
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;


        @if (@ViewBag.PoslOrderLink > 0)
        {
            <tr style="vertical-align: top;">
                @try
                {
                    @Html.ActionLink("Следующий заказ", "OpenOrder", "RKD", new { idOrder = @ViewBag.PoslOrderLink }, null)
                }
                catch
                {

                }
            </tr>
        }
    </table>
    <div style="width: 1000px">
        <h4>Необходимо направить РКД Заказчику или на доработку в КО</h4>
        <h4>№ заказа: @ViewBag.PlanZakaz</h4>
        <h5>Заказчик: @ViewBag.Client</h5>
        <h5>Проектный институт: @ViewBag.Inst</h5>
        @Html.ActionLink("Изменить проектный институт", "EditInst", "RKD", new { id = ViewBag.idOrder }, new { @class = "viewDialog", data_dialog_title = "Выберете проектный институт" })
        <h5>Наименование заказа (контрактное): @ViewBag.PlanZakazName</h5>
    </div>

    @using (Html.BeginForm("UploadClient", "RKD", FormMethod.Post, new { enctype = "multipart/form-data" }))
    {
        @Html.AntiForgeryToken()

        @Html.ActionLink("Назад", "Index", null, new { @class = "btn btn-warning" })

        <hr />
        <div class="form-horizontal">
            @Html.HiddenFor(model => model.id)
            @Html.HiddenFor(model => model.id_PZ_PlanZakaz)
            <h4>Выберете количество дней, необходимых для получения ответа от Заказчика</h4>
            @Html.DropDownList("day", null, htmlAttributes: new { @class = "form-control" })
            <br />
            <input type="submit" value="РКД отправлено Заказчику" class="btn btn-info" />
            <br />
            <br />
            @Html.ActionLink("Отправить РКД на доработку", "ErrorNewVersionRDK", new { id_RKD_Order = @Model.id }, new { @class = "btn btn-danger" })
            <hr />
            @Html.ActionLink("Добавить запись", "CreateNewDespatching", "RKD", new { idOrder = ViewBag.idOrder }, new { @class = "viewDialog", data_dialog_title = "Внесите данные обсуждения" })
            <table class="table table-hover" style="width:1500px">
                <thead>
                    <tr>
                        <th> Дата </th>
                        <th> Описание </th>
                        <th> ФИО </th>
                        <th> Срок </th>
                    </tr>
                </thead>
                <tbody id="myTable">
                    @foreach (var item in ViewBag.Despatching)
                    {

                        if (item.TypeTask == 0)
                        {
                            <tr>
                                <td> @item.DateEvent.ToString().Substring(0, 16) </td>
                                <td> @item.TextData </td>
                                <td> @item.UserID </td>
                                <td> @item.TaskFinishDate </td>
                            </tr>
                        }
                        else if (item.TypeTask == 100)
                        {
                            <tr>
                                <td class="warning"> @item.DateEvent.ToString().Substring(0, 16) </td>
                                <td class="warning"> @item.TextData </td>
                                <td class="warning"> @item.UserID </td>
                                <td class="warning"> @item.TaskFinishDate </td>
                            </tr>
                        }
                        else
                        {
                            <tr>
                                <td class="active"> @item.DateEvent.ToString().Substring(0, 16) </td>
                                <td class="active"> @item.TextData </td>
                                <td class="active"> @item.UserID </td>
                                <td class="active"> @item.TaskFinishDate </td>
                            </tr>
                        }
                    }
                </tbody>
            </table>
        </div>
    }



    <script src='@Url.Content("~/Scripts/jquery-3.1.1.min.js")' type="text/javascript"></script>
    <script src='@Url.Content("~/Scripts/jquery-ui-1.12.1.min.js")' type="text/javascript"></script>
    <script>
        $(document).ready(function () {
            $.ajaxSetup({ cache: false });
            $(".viewDialog").on("click", function (e) {
                e.preventDefault();
                $("<div></div>")
                    .addClass("dialog")
                    .appendTo("body")
                    .dialog({
                        title: $(this).attr("data-dialog-title"),
                        close: function () { $(this).remove() },
                        width: 1000,
                        height: 550,
                        modal: true

                    })
                    .load(this.href);
            });
        });
    </script>
    <script>
        $(document).ready(function () {
            $.ajaxSetup({ cache: false });
            $(".btn btn-danger").on("click", function (e) {
                e.preventDefault();
                $("<div></div>")
                    .addClass("dialog")
                    .appendTo("body")
                    .dialog({
                        title: $(this).attr("data-dialog-title"),
                        close: function () { $(this).remove() },
                        width: 1000,
                        height: 550,
                        modal: true

                    })
                    .load(this.href);
            });
        });
    </script>
</div>
    <div class="col-sm-1"></div>
    </div>
</body>
</html>