@model IEnumerable<Wiki.Debit_WorkBit>
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<head>
    <link href="~/Content/Scripts/bootstrap-table.min.css" rel="stylesheet" />
    <link href="~/Content/Scripts/bootstrap.min.css" rel="stylesheet" />
    <style>
        .container {
            height: 630px;
            width: 1600px;
            overflow: auto;
        }

        th {
            background: #000080; /* Цвет фона строки заголовка */
            color: #ffe; /* Цвет текста */
            text-align: left; /* Выравнивание по левому краю */
            font-family: Arial, Helvetica, sans-serif; /* Выбор гарнитуры */
            font-size: 0.9em; /* Размер текста */
        }
    </style>
</head>
<h2>Мои активные задачи</h2>
<span>
    <br />
    <a href="~/Debit_WorkBit/Index" class="btn btn-primary" role="button">Мои активные задачи</a>
    <a href="~/Debit_WorkBit/IndexBrows" class="btn btn-primary" role="button">Активные задачи по заказам</a>
    <a href="~/PZ_TEO/Index" class="btn btn-primary" role="button">Справочник ТЭО</a>
    <a href="~/PZ_Setup/Index" class="btn btn-primary" role="button">Договорные условия</a>
    <a href="~/Debit_WorkBit/UpdateFolderPZ" class="btn btn-primary" role="button">Получить перечень файлов</a>
    <br />
    <br />
    <a href="http://tsqlserver/Reports/Pages/Report.aspx?ItemPath=%2fDashboard_EveryDay%2fDashboard%2f%d0%94%d0%b5%d0%b1%d0%b8%d1%82%d0%be%d1%80%d0%ba%d0%b0" class="btn btn-info" role="button">Отчет (полная форма)</a>
    <a href="~/Debit_WorkBit/ReportBasic" class="btn btn-primary" role="button">Отчет (сокращенная форма)</a>
    <a href="~/Debit_WorkBit/RemainingList" class="btn btn-info" role="button">Ожидание прихода средств</a>
    <br />
    <br />
    <input class="form-control" id="myInput" type="text" placeholder="Поиск...">
    <br />
</span>
<div class="container">
    <table data-toggle="table"
           data-height="630">
        <thead>
            <tr>
                <th>Ред.</th>
                <th data-sortable="true">Заказ</th>
                <th data-sortable="true">Задача</th>
                <th data-sortable="true">Заказчик</th>
                <th data-sortable="true">Договор</th>
                <th data-sortable="true">Приложение</th>
                <th data-sortable="true">СФ</th>
                <th data-sortable="true">СФ дата</th>
                <th data-sortable="true">Плановая дата</th>
            </tr>
        </thead>
        <tbody id="myTable">
            @foreach (var item in Model)
            {
                if (item.datePlan > DateTime.Now)
                {
            <tr>
                <td> @Html.ActionLink("Ред.", "Edit", new { id = item.id, idTask = item.id_TaskForPZ }) </td>
                <td> @Html.DisplayFor(modelItem => item.PZ_PlanZakaz.PlanZakaz) </td>
                <td> @Html.DisplayFor(modelItem => item.TaskForPZ.taskName)</td>
                <td> @Html.DisplayFor(modelItem => item.PZ_PlanZakaz.PZ_Client.NameSort) </td>
                <td> @Html.DisplayFor(modelItem => item.PZ_PlanZakaz.timeContract) </td>
                <td> @Html.DisplayFor(modelItem => item.PZ_PlanZakaz.timeArr) </td>
                <td>
                    @try
                    {
                        @Html.DisplayFor(modelItem => item.PZ_PlanZakaz.Debit_WorkBit.Where(d => d.id_TaskForPZ == 11).First().Debit_TN.Where(d => d.id_DebitTask > 0).First().numberSF)
                    }
                    catch
                    {
                        <p>НД</p>
                    }
                </td>
                <td>
                    @try
                    {
                        @DateTime.Parse(Html.DisplayFor(modelItem => item.PZ_PlanZakaz.Debit_WorkBit.Where(d => d.id_TaskForPZ == 11).First().Debit_TN.Where(d => d.id_DebitTask > 0).First().dateSF).ToString()).ToShortDateString()

                    }
                    catch
                    {
                        <p>НД</p>
                    }
                </td>
                <td> @DateTime.Parse(Html.DisplayFor(modelItem => item.datePlan).ToString()).ToShortDateString() </td>
            </tr>
                }
                else
                {
                    <tr class="warning">
                        <td> @Html.ActionLink("Ред.", "Edit", new { id = item.id, idTask = item.id_TaskForPZ }) </td>
                        <td> @Html.DisplayFor(modelItem => item.PZ_PlanZakaz.PlanZakaz) </td>
                        <td> @Html.DisplayFor(modelItem => item.TaskForPZ.taskName)</td>
                        <td> @Html.DisplayFor(modelItem => item.PZ_PlanZakaz.PZ_Client.NameSort) </td>
                        <td> @Html.DisplayFor(modelItem => item.PZ_PlanZakaz.timeContract) </td>
                        <td> @Html.DisplayFor(modelItem => item.PZ_PlanZakaz.timeArr) </td>
                        <td>
                            @try
                            {
                                @Html.DisplayFor(modelItem => item.PZ_PlanZakaz.Debit_WorkBit.Where(d => d.id_TaskForPZ == 11).First().Debit_TN.Where(d => d.id_DebitTask > 0).First().numberSF)
                            }
                            catch
                            {
                                <p>НД</p>
                            }
                        </td>
                        <td>
                            @try
                            {
                                @DateTime.Parse(Html.DisplayFor(modelItem => item.PZ_PlanZakaz.Debit_WorkBit.Where(d => d.id_TaskForPZ == 11).First().Debit_TN.Where(d => d.id_DebitTask > 0).First().dateSF).ToString()).ToShortDateString()

                            }
                            catch
                            {
                                <p>НД</p>
                            }
                        </td>
                        <td> @DateTime.Parse(Html.DisplayFor(modelItem => item.datePlan).ToString()).ToShortDateString() </td>
                    </tr>
                }
            }
        </tbody>
    </table>
</div>
<script>
    $(document).ready(function () {
        $("#myInput").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $("#myTable tr").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
    });
</script>
<script>
    $('table').tfh({
        trigger: 0,
        top: 0
    });
</script>
<script src="~/Content/Scripts/jquery.min.js"></script>
<script src="~/Content/Scripts/bootstrap-table.min.js"></script>